import{r as e,f as a,q as t,o as l,c as o,w as n,x as i,y as r,L as s,b as d,T as c,J as u,W as p,S as m,g as w,n as f,a1 as h,ae as v,af as g,ag as b,ah as y,ab as _,ac as x,aa as j,U as k,H as z}from"./element-plus-DF9tb4vq.js";import{_ as C}from"./MyDrawer-a0Jz_Wxp.js";import{_ as U}from"./MainPanel-BzHApMOP.js";import{p as V,g as R,_ as L}from"./index-kDNrUbLd.js";import{u as S}from"./useTable-BsUWHsBc.js";import"./index-B8qrbVBv.js";const D=e=>V("",e),O=(e,a)=>{var t;const l=e.headers;let o;const n=l["content-type"],i=decodeURIComponent(l["content-disposition"]||"");let r=(null==(t=i.match(/\.\S+$/))?void 0:t[0])||"";const s=((e,a="")=>{const t=new RegExp("(|&|;)"+e+"=(\"|')?([^&;\"']*)(\"|')?$");a||(a=window.location.hash.slice(1));const l=a.match(t);return l?decodeURIComponent(l[3]):""})("filename",i);r||(r=".xlsx"),o=s||""+(new Date).toLocaleDateString().split("/").map((e=>e.length<2?"0"+e:e)).join("")+r,((e,a,t)=>{const l=new Blob([e],{type:a}),o=document.createElement("a"),n=window.URL.createObjectURL(l);o.href=n,o.download=t,o.download||o.setAttribute("target","_blank"),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(n)})(e.data,n,o)},E={class:"pb-15"},I={class:"table-wrapper"},P={class:"pagination-wrapper"},T=r({name:"Example"}),q=L(Object.assign(T,{setup(r){const{tableData:L,pagination:T,setTable:q}=S([]),A=e=>{T.value={...T.value,current:e},M()},F=e=>{T.value={...T.value,current:1,size:e},M()},B=e(!1),M=async()=>{B.value=!0;const{current:e,size:a}=T.value,t={current:e,size:a},l=await(e=>V("/user/list",e))(t).catch((e=>(B.value=!1,Promise.reject()))),{list:o,...n}=l.data;L.value=o,T.value={...T.value,current:n.current,size:n.size,total:n.total},B.value=!1};M();const N=a({data1:"",data2:""}),$=a({title:t((()=>$[$.method])),method:"",id:"",add:"新增",edit:"修改"}),H=e(),J=e(!1),W=e(!1),G=(e,a)=>{X(),(e=>{if(!e)return;const a=e=>Object.prototype.toString.call(e).slice(8,-1);for(const t in e){const l=e[t];Array.isArray(l)?e[t]=[]:"Object"===a(l)?e[t]={}:"Boolean"===a(l)?e[t]=!1:"Number"===a(l)?e[t]=0:e[t]=""}})(N),$.method=e,J.value=!0,f((()=>{var t;null==(t=H.value)||t.resetFields(),"edit"===e&&(((e={},a={})=>{for(const t in e)e[t]=a[t]})(N,a),$.id=a.id)}))},K=e(!1),Q=e({}),X=async()=>{const e=await((e={})=>R("/user/downloadExcel",e,{responseType:"blob"}))();O(e)},Y=async()=>{if(await H.value.validateFields()){W.value=!0;try{"add"===$.method?await(async()=>{const e=await D(N).catch((e=>Promise.reject()));(null==e?void 0:e.data)&&z.success("新增数据成功")})():"edit"===$.method&&await(async()=>{const e=await D($.id);(null==e?void 0:e.data)&&z.success("修改数据成功")})(),W.value=!1,J.value=!1}catch(e){W.value=!1}}};return(e,a)=>{const t=h,r=v,f=g,z=b,V=y,R=C,S=_,D=x,O=j;return l(),o(U,{loading:i(B)},{default:n((()=>[s("div",E,[d(t,{type:"primary",onClick:a[0]||(a[0]=e=>G("add"))},{default:n((()=>[c(" 添加数据 ")])),_:1})]),s("div",I,[d(z,{data:i(L),border:""},{default:n((()=>[d(r,{prop:"id",label:"ID","min-width":"120","show-overflow-tooltip":"",align:"center"}),d(r,{prop:"name",label:"姓名","min-width":"120","show-overflow-tooltip":"",align:"center"}),d(r,{prop:"age",label:"年龄","min-width":"120","show-overflow-tooltip":"",align:"center"}),d(r,{prop:"sex",label:"性别","min-width":"120","show-overflow-tooltip":"",align:"center"}),d(r,{prop:"description",label:"内容","min-width":"120","show-overflow-tooltip":"",align:"center"}),d(r,{label:"图片","min-width":"120","show-overflow-tooltip":"",align:"center"},{default:n((({row:e})=>[d(f,{src:e.file},null,8,["src"])])),_:1}),d(r,{prop:"fileName",label:"图片名称","min-width":"120","show-overflow-tooltip":"",align:"center"}),d(r,{label:"操作",fixed:"right",align:"center"},{default:n((({row:e})=>[d(t,{link:"",type:"primary",onClick:a=>(e=>{K.value=!0,Q.value=e})(e)},{default:n((()=>[c(" 查看详情 ")])),_:2},1032,["onClick"]),d(t,{link:"",type:"primary",onClick:a=>G("edit",e)},{default:n((()=>[c(" 编辑 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),s("div",P,[d(V,{"current-page":i(T).current,"onUpdate:currentPage":a[1]||(a[1]=e=>i(T).current=e),"page-size":i(T).size,"onUpdate:pageSize":a[2]||(a[2]=e=>i(T).size=e),total:i(T).total,"page-sizes":[10,20,50,100,200,300],layout:"total, sizes, prev, pager, next, jumper",background:"","hide-on-single-page":"",onCurrentChange:A,onSizeChange:F},null,8,["current-page","page-size","total"])]),d(R,{modelValue:i(K),"onUpdate:modelValue":a[3]||(a[3]=e=>w(K)?K.value=e:null),title:"详情","cancel-text":"关闭","show-confirm":!1},{default:n((()=>[(l(!0),u(m,null,p(i(Q),((e,a)=>(l(),u("p",{key:a},k(e),1)))),128))])),_:1},8,["modelValue"]),d(R,{modelValue:i(J),"onUpdate:modelValue":a[6]||(a[6]=e=>w(J)?J.value=e:null),width:"500px",title:i($).title,onConfirm:Y},{default:n((()=>[d(O,{model:i(N),ref_key:"exampleFormRef",ref:H,autocomplete:"off","label-width":"100px"},{default:n((()=>[d(D,{label:"数据1",prop:"data1",rules:[{required:!0,message:"请输入数据1"}]},{default:n((()=>[d(S,{placeholder:"请输入数据1",modelValue:i(N).data1,"onUpdate:modelValue":a[4]||(a[4]=e=>i(N).data1=e)},null,8,["modelValue"])])),_:1}),d(D,{label:"数据2",prop:"data2",rules:[{required:!0,message:"请输入数据2"}]},{default:n((()=>[d(S,{placeholder:"请输入数据2",modelValue:i(N).data2,"onUpdate:modelValue":a[5]||(a[5]=e=>i(N).data2=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])),_:1},8,["loading"])}}}),[["__scopeId","data-v-e5dd0fe6"]]);export{q as default};
